<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<dom-module id="transport-service">
    <template>
        <iron-ajax
            method="post"
            id="getrouteajax"
            url="{{getrouteurl}}"
            params="{{getrouteparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getrouteResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getroutedetailajax"
            url="{{getroutedetailurl}}"
            params="{{getroutedetailparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getroutedetailResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="insertpointajax"
            url="{{insertpointurl}}"
            params="{{insertpointparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="insertpointResponse"
            debounce-duration="300"
            >
        </iron-ajax>
          <iron-ajax
            method="post"
            id="routeidajax"
            url="{{routeidurl}}"
            params="{{routeidparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="routeidResponse"
            debounce-duration="300"
            >
        </iron-ajax>
          <iron-ajax
            method="post"
            id="sequenceajax"
            url="{{sequenceurl}}"
            params="{{sequenceparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="sequenceResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getzoneajax"
            url="{{getzoneurl}}"
            params="{{getzoneparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getzoneResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getfeeajax"
            url="{{getfeeurl}}"
            params="{{getfeeparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getfeeResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="setzoneajax"
            url="{{setzoneurl}}"
            params="{{setzoneparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="setzoneResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getnameajax"
            url="{{getnameurl}}"
            params="{{getnameparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getnameResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="stupassgetnameajax"
            url="{{stupassgetnameurl}}"
            params="{{stupassgetnameparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="stupassgetnameResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="stufeegetnameajax"
            url="{{stufeegetnameurl}}"
            params="{{stufeegetnameparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="stufeegetnameResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getstudetailajax"
            url="{{getstudetailurl}}"
            params="{{getstudetailparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getstudetailResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="genereportajax"
            url="{{genereporturl}}"
            params="{{genereportparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="genereportResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="gettripajax"
            url="{{gettripurl}}"
            params="{{gettripparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="gettripResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="cancellationajax"
            url="{{cancellationurl}}"
            params="{{cancellationparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="cancellationResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="cancelajax"
            url="{{cancelurl}}"
            params="{{cancelparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="cancelResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="proceedcancelajax"
            url="{{proceedcancelurl}}"
            params="{{proceedcancelparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="proceedcancelResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="transportrequiredstatusajax"
            url="{{transportrequiredstatusurl}}"
            params="{{transportrequiredstatusparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="transportrequiredstatusResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="gettermdateajax"
            url="{{gettermdateurl}}"
            params="{{gettermdateparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="gettermdateResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="nameajax"
            url="{{nameurl}}"
            params="{{nameparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="nameResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="generatereportbynameajax"
            url="{{generatereportbynameurl}}"
            params="{{generatereportbynameparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="generatereportbynameResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="generateroutereportajax"
            url="{{generateroutereporturl}}"
            params="{{generateroutereportparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="generateroutereportResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="deletemappointajax"
            url="{{deletemappointurl}}"
            params="{{deletemappointparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="deletemappointResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getstudapprovalajax"
            url="{{getstudapprovalurl}}"
            params="{{getstudapprovalparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getstudapprovalResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="confirmdiscajax"
            url="{{confirmdiscurl}}"
            params="{{confirmdiscparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="confirmdiscResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getapprovalverifyajax"
            url="{{getapprovalverifyurl}}"
            params="{{getapprovalverifyparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getapprovalverifyResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="confirmedfeeajax"
            url="{{confirmedfeeurl}}"
            params="{{confirmedfeeparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="confirmedfeeResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="confirmfeeajax"
            url="{{confirmfeeurl}}"
            params="{{confirmfeeparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="confirmfeeResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="cancelledfeeajax"
            url="{{cancelledfeeurl}}"
            params="{{cancelledfeeparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="cancelledfeeResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="classajax"
            url="{{classurl}}"
            params="{{classparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="classResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="statuschangeajax"
            url="{{statuschangeurl}}"
            params="{{statuschangeparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="statuschangeResponse"
        >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="studzoneajax"
            url="{{studzoneurl}}"
            params="{{studzoneparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="studzoneResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="pointflagajax"
            url="{{pointflagurl}}"
            params="{{pointflagparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="pointflagResponse"
            debounce-duration="300">
        </iron-ajax>
        <iron-ajax
            id="updatezoneajax"
            url="{{updatezoneurl}}"
            params="{{updatezoneparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="updatezoneResponse"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="routereportajax"
            url="{{routereporturl}}"
            params="{{routereportparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="routereportResponse">
        </iron-ajax>
        <iron-ajax
            method="post"
            id="studentpickroutereportajax"
            url="{{studentpickroutereporturl}}"
            params="{{studentpickroutereportparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="studentpickroutereportResponse">
        </iron-ajax>
        <iron-ajax
            method="post"
            id="studentdroproutereportajax"
            url="{{studentdroproutereporturl}}"
            params="{{studentdroproutereportparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="studentdroproutereportResponse">
        </iron-ajax>
        <iron-ajax
            id="onewayajax"
            url="{{onewayurl}}"
            handle-as="json"
            content-type="application/json"
            on-response="onewayResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            id="onecusajax"
            url="{{onecusurl}}"
            handle-as="json"
            content-type="application/json"
            on-response="onecusResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getpassdetailajax"
            url="{{getpassdetailurl}}"
            params="{{getpassdetailparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getpassdetailResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getzonedetailajax"
            url="{{getzonedetailurl}}"
            params="{{getzonedetailparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getzonedetailResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getppnameajax"
            url="{{getppnameurl}}"
            params="{{getppnameparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getppnameResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getpickrouajax"
            url="{{getpickrouurl}}"
            params="{{getpickrouparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getpickrouResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getdroprouajax"
            url="{{getdroprouurl}}"
            params="{{getdroprouparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getdroprouResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getdpnameajax"
            url="{{getdpnameurl}}"
            params="{{getdpnameparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getdpnameResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getpassnameajax"
            url="{{getpassnameurl}}"
            params="{{getpassnameparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getpassnameResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getfeedetailajax"
            url="{{getfeedetailurl}}"
            params="{{getfeedetailparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getfeedetailResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getfeeparentajax"
            url="{{getfeeparenturl}}"
            params="{{getfeeparentparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getfeeparentResponse"
            debounce-duration="300"
            >
        </iron-ajax>

        <iron-ajax
            method="post"
            id="getfeechequeajax"
            url="{{getfeechequeurl}}"
            params="{{getfeechequeparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getfeechequeResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getpassclassajax"
            url="{{getpassclassurl}}"
            params="{{getpassclassparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getpassclassResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="getparentinfoajax"
            url="{{getparentinfourl}}"
            params="{{getparentinfoparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getparentinfoResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="classesajax"
            url="{{classurl}}"
            handle-as="json"
            content-type="application/json"
            on-response="classesResponse"
            debounce-duration="300"
            >
        </iron-ajax>
        <iron-ajax
            method="post"
            id="addstudentajax"
            url="{{addstudenturl}}"
            params="{{addstudentparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="addstudentResponse"
            debounce-duration="300"
            >
        </iron-ajax>

        <iron-ajax
            method="post"
            id="addparentajax"
            url="{{addparenturl}}"
            params="{{addparentparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="addparentResponse"
            debounce-duration="300"
            >
        </iron-ajax>
       <iron-ajax
            method="post"
            id="getrouteidajax"
            url="{{getrouteidurl}}"
            params="{{getrouteidparam}}"
            handle-as="json"
            content-type="application/json"
            on-response="getrouteidResponse"
            debounce-duration="300"
            >
      </iron-ajax>
        <!--To fetch Parent name for zone mapping-->
        <iron-ajax
          method="post"
          id="parentdetailajax"
          url="{{parentnameurl}}"
          params="{{parentnameparam}}"
          handle-as="json"
          content-type="application/json"
          on-response="parentnameResponse"
          debounce-duration="300"
        >
        </iron-ajax>
        <iron-ajax
          method="post"
          id="getchequedetailsbynameajax"
          url="{{getchequedetailsbynameurl}}"
          params="{{getchequedetailsbynameparam}}"
          handle-as="json"
          content-type="application/json"
          on-response="getchequedetailsbynameResponse"
          debounce-duration="300"
        >
        </iron-ajax>
        <iron-ajax
          method="post"
          id="getchequedetailsajax"
          url="{{getchequedetailsurl}}"
          params="{{getchequedetailsparam}}"
          handle-as="json"
          content-type="application/json"
          on-response="editchequeResponse"
          debounce-duration="300"
        >
        </iron-ajax>
        <iron-ajax
          method="post"
          id="geteditchequeajax"
          url="{{geteditchequeurl}}"
          params="{{geteditchequeparam}}"
          handle-as="json"
          content-type="application/json"
          on-response="geteditchequeResponse"
          debounce-duration="300"
        >
        </iron-ajax>
        <iron-ajax
          method="post"
          id="verifyajax"
          url="{{verifyurl}}"
          params="{{verifyparam}}"
          handle-as="json"
          content-type="application/json"
          on-response="verifyResponse"
          debounce-duration="300"
        >
        </iron-ajax>
    </template>
  <script>
  (function() {
    var point;
    var trip;
    var pick;
    var drop;
    var routeidd;
    var pointcount;
    var routetrip="";
    var totalfee;
    var months;
    var calcfee;
    var cancelfee;
    var cancelpaid;
    var cusfee;
    var yearlyfee;
    var val;
    var oneway;
    var zstuname;
    var distance;
    var parent_name;
    var parent_mobile;
    var parent_email;
    var address_1;
    var address_2;
    var address_3;
    var city;
    var pincode;
    var rouid;
    var feedet;
    var studentname;
    var feeparent;
    var editchequedetail
var school=sessionStorage.getItem("sch");
    Polymer({
      is: "transport-service",

     FnClear:function(){
  point="";
     trip="";
     pick="";
     drop="";
     routeidd="";
     routetrip="";
     totalfee="";
     months="";
     calcfee="";
     cancelfee="";
     cancelpaid="";
     cusfee="";
     yearlyfee="";
     val="";
    oneway="";
     zstuname="";
     distance="";
     parent_name="";
     parent_mobile="";
     parent_email="";
     address_1="";
     address_2="";
     address_3="";
     city="";
     pincode="";
     },
       getroute:function()
      {
        this.getrouteurl=sessionStorage.getItem("addrinfo")+"/getroute";
        var obj={"schol":""}
        obj.schol=sessionStorage.getItem("sch");
        this.getrouteparam=obj;
        this.$.getrouteajax.generateRequest();
      },
      getrouteResponse:function(e1)
      {
         a2=e1.detail.response.returnval;
        document.querySelector('mappointtoroute-card').routearr=a2;
      },
       getroutedetail:function(tripno)
      {
        //alert('Hi  ...   '+routetrip);
        this.getroutedetailurl=sessionStorage.getItem("addrinfo")+"/getroutedetail";
        var obj={"routename":"","tripnos":"","schol":""};
        obj.schol=sessionStorage.getItem("sch");
        obj.routename=routetrip;
        obj.tripnos=tripno;
        this.getroutedetailparam=obj;
        //alert(JSON.stringify(obj));
        this.$.getroutedetailajax.generateRequest();
      },
      getroutedetailResponse:function(e1)
          {
          var routedetails=e1.detail.response.returnval;
          //alert(JSON.stringify(routedetails));
          document.querySelector('mappointtoroute-card').itemarr=routedetails;
      },

      insertpoint:function(route,pt,pickuptime,droptime,tripp,dist)
      {
        //alert('insert');
        point=pt;
        trip=tripp;
        pick=pickuptime;
        drop=droptime;
        distance=dist;
        this.routeidurl=sessionStorage.getItem("addrinfo")+"/routeid";
        var obj={"id":""};
        obj.id='point';
        this.routeidparam=obj;
        this.$.routeidajax.generateRequest();
      },
      insertpointResponse:function(e){
        //alert('responsefin');
        var result=e.detail.response.returnval;
        if(result=='success')
        {
            alert('The point is mapped to route');
            document.querySelector('mappointtoroute-card').refreshdeletedata();
        }
        else
        {
            alert('The point is not mapped to route');
        }
      },
      routeidResponse:function(e)
      {
        pointcount=(e.detail.response.returnval[0].count)+1;
        this.sequenceurl=sessionStorage.getItem("addrinfo")+"/sequence";
        var obj={"pointcoun":"","id":""}
        obj.id='point';
        obj.pointcoun=pointcount;
        this.sequenceparam=obj;
        this.$.sequenceajax.generateRequest();

      },
      sequenceResponse:function(e)
      {
        var seq=pointcount;
        var obj={"id":"","routes":"","points":"","trip":"","pick":"","drop":"","distance":"","schol":""}
        obj.schol=sessionStorage.getItem("sch");
        obj.id="p"+seq;
        obj.routes=sessionStorage.getItem("routid");
        obj.points=point;
        obj.trip=trip;
        obj.pick=pick;
        obj.drop=drop;
        obj.distance=distance;
        this.insertpointparam=obj;
        this.insertpointurl=sessionStorage.getItem("addrinfo")+"/insertpoint";
        this.$.insertpointajax.generateRequest();

      },
         getzone:function()

      {
        this.getzoneurl=sessionStorage.getItem("addrinfo")+"/getzone";
        var obj={"schol":""}
        obj.schol=sessionStorage.getItem("sch");
        this.getzoneparam=obj;
        this.$.getzoneajax.generateRequest();
      },
      getzoneResponse:function(e1)
          {
            var zoneitem=e1.detail.response.returnval;
            document.querySelector('zonetostudent-card').itemarr=zoneitem;
      },
      getfee:function(zone)
      {
        this.getfeeurl = sessionStorage.getItem("addrinfo")+"/getfee";
        var obj={"zone":"","schol":""}
        obj.zone=zone;
        obj.schol=sessionStorage.getItem("sch");
        this.getfeeparam=obj;
        this.$.getfeeajax.generateRequest();
      },
      getfeeResponse:function(e){
         totalfee=e.detail.response.returnval[0].fees;
          document.querySelector('zonetostudent-card').fee=totalfee;
      },
      calc:function(values){
      if(values=='foryear'){
        yearlyfee=totalfee;
        //alert(yearlyfee);
   }
      },
      gettermdate:function(grade){
         this.gettermdateurl=sessionStorage.getItem("addrinfo")+"/gettermdate";
         var obj={"grade":"","schol":""}
         obj.schol=sessionStorage.getItem("sch");
         obj.grade=grade;
         this.gettermdateparam=obj;
        this.$.gettermdateajax.generateRequest();
      },
         gettermdateResponse:function(e1)
          {
            var fromdate1=e1.detail.response.returnval[0].start_date;
            var todate1=e1.detail.response.returnval[0].end_date;
            document.querySelector('zonetostudent-card').zfromdate=fromdate1;
            document.querySelector('zonetostudent-card').ztodate=todate1;
            document.querySelector('zonetostudent-card').setzonedate(fromdate1,todate1);

      },
      setzone:function(studid,zone,fee,fromdatez,todatez,modez,namex,todayx,statusx,stuname)
      {
        zstuname=stuname;
        this.setzoneurl = sessionStorage.getItem("addrinfo")+"/setzone";
        var obj={"studid":"","zone":"","fee":"","fromdate":"","todate":"","mode":"","name":"","today":"","status":"","schol":""};
        obj.schol=sessionStorage.getItem("sch");
        obj.studid=studid;
        obj.zone=zone;
        obj.fee=fee;
        obj.fromdate=fromdatez;
        obj.todate=todatez;
        obj.mode=modez;
        obj.name=namex;
        obj.today=todayx;
        obj.status=statusx;
        this.setzoneparam=obj;
       // alert(JSON.stringify(obj));
        this.$.setzoneajax.generateRequest();
      },
      setzoneResponse:function(e){
         var result=e.detail.response.returnval;
         //alert(result);
         if(result=="success")
         {
          alert('Zone allocated successfully');
          document.querySelector('transportfee-service').zonefee(zstuname);
         }
         else
         {
          alert('Duplicate Entry');
         }
      },


       getname:function()
      {
        //alert('hi service');
        this.getnameurl=sessionStorage.getItem("addrinfo")+"/getname";
        var obj={"schol":""}
        obj.schol=sessionStorage.getItem("sch");
        this.getnameparam=obj;
        this.$.getnameajax.generateRequest();
      },
        stupassgetname:function()
      {
        //alert('hi service');
        this.stupassgetnameurl=sessionStorage.getItem("addrinfo")+"/stupassgetname";
        var obj={"schol":""}
        obj.schol=sessionStorage.getItem("sch");
        this.stupassgetnameparam=obj;
        this.$.stupassgetnameajax.generateRequest();
      },
       stufeegetname:function()
      {
        //alert('hi service');
        this.stufeegetnameurl=sessionStorage.getItem("addrinfo")+"/stufeegetname";
        var obj={"schol":""}
        obj.schol=sessionStorage.getItem("sch");
        this.stufeegetnameparam=obj;
        this.$.stufeegetnameajax.generateRequest();
      },
      getnameResponse:function(e1)
          {
            var iditem=e1.detail.response.returnval;
            //document.querySelector('zonetostudent-card').studentidarr=iditem;
            document.querySelector('zonetostudent-card').autocompletearr(iditem);
            //document.querySelector('studentpass-card').autocompletearr(iditem);
            //alert(JSON.stringify(document.querySelector('zonetostudent-card').namearr));
      },
 stupassgetnameResponse:function(e1)
          {
            var iditem1=e1.detail.response.returnval;
            document.querySelector('studentpass-card').autocompletearr(iditem1);

      },
       stufeegetnameResponse:function(e1)
          {
            var iditem2=e1.detail.response.returnval;
            document.querySelector('feereceipt-card').autocompletearr(iditem2);

      },
      getstudetail:function(studid)
      {
        this.getstudetailurl=sessionStorage.getItem("addrinfo")+"/getstudetail";
        var obj={"studid":"","schol":""};
        obj.studid=studid;
        obj.schol=sessionStorage.getItem("sch");
        this.getstudetailparam=obj;
        this.$.getstudetailajax.generateRequest();

        this.parentnameurl=sessionStorage.getItem("addrinfo")+"/getparentname";
        this.parentnameparam=obj;
        //alert(JSON.stringify(obj));
        this.$.parentdetailajax.generateRequest();
      },
      parentnameResponse:function(e){
        var parentname= e.detail.response.returnval[0].parent_name;
        document.querySelector('zonetostudent-card').parent=parentname;
      },
      getstudetailResponse:function(e1)
          {
            var profilename=e1.detail.response.returnval[0].student_name;
            var gradename=e1.detail.response.returnval[0].school_type;
            var dob=e1.detail.response.returnval[0].dob;
            var stdid=e1.detail.response.returnval[0].id;
            var classz=e1.detail.response.returnval[0].class_id;
            document.querySelector('zonetostudent-card').name=profilename;
            document.querySelector('zonetostudent-card').grade=gradename;
            document.querySelector('zonetostudent-card').date=dob;
            document.querySelector('zonetostudent-card').id=stdid;

            this.classurl=sessionStorage.getItem("addrinfo")+"/getclass";
            var obj1={"class":"","schol":""}
            obj1.class=classz;
            obj1.schol=sessionStorage.getItem("sch");
            this.classparam=obj1;
            this.$.classajax.generateRequest();

      },
      classResponse:function(e){
        var stnd=e.detail.response.returnval[0].class;
        var secn=e.detail.response.returnval[0].section;
        document.querySelector('zonetostudent-card').stnd=stnd;
        document.querySelector('zonetostudent-card').secn=secn;
      },

      generatereport:function(studid){
        this.genereporturl=sessionStorage.getItem("addrinfo")+"/report-card";
        var obj={"studid":""}
        obj.studid=studid;
        this.genereportparam=obj;
        this.$.genereportajax.generateRequest();
      },
      genereportResponse:function(e){
        //alert(JSON.stringify(e.detail.response.returnval));
        var reportresult=e.detail.response.returnval;
        document.querySelector('genestureport-card').reportarr=reportresult;
      },
      generateroutereport:function(){
        this.generateroutereporturl=sessionStorage.getItem("addrinfo")+"/generateroutereport";
        var obj={"schol":""}
        obj.schol=sessionStorage.getItem("sch");
        this.generateroutereportparam=obj;
        this.$.generateroutereportajax.generateRequest();
      },
      generateroutereportResponse:function(e){
        var nameitem=e.detail.response.returnval;
        document.querySelector('routereport-card').autocompletename(nameitem);
      },
      routereport:function(routeid){
        this.routereporturl=sessionStorage.getItem("addrinfo")+"/route-report-card";
        var obj={"routeid":""}
        obj.routeid=routeid;
        this.routereportparam=obj;
        //alert(JSON.stringify(obj));
        this.$.routereportajax.generateRequest();
      },

      routereportResponse:function(e){
        //alert(JSON.stringify(e.detail.response.returnval));
        var routereportresult=e.detail.response.returnval;
        document.querySelector('routereport-card').reportarr=routereportresult;
      },
      studentroutereport:function(routeid,tripid,pickordrop)
      {
        if(pickordrop=="Pickup")
        {
this.studentpickroutereporturl=sessionStorage.getItem("addrinfo")+"/studentpickroute-report-card";
        var obj={"routeid":"","tripid":"","schol":""}
        obj.schol=sessionStorage.getItem("sch");
        obj.routeid=routeid;
        obj.tripid=tripid;
        this.studentpickroutereportparam=obj;
        //alert(JSON.stringify(obj));
        this.$.studentpickroutereportajax.generateRequest();
      }
      else
      {
        this.studentdroproutereporturl=sessionStorage.getItem("addrinfo")+"/studentdroproute-report-card";
        var obj={"routeid":"","tripid":"","schol":""}
        obj.schol=sessionStorage.getItem("sch");
        obj.routeid=routeid;
        obj.tripid=tripid;
        this.studentdroproutereportparam=obj;
        //alert(JSON.stringify(obj));
        this.$.studentdroproutereportajax.generateRequest();
      }
      },
      studentpickroutereportResponse:function(e)
      {
        var routereportresult=e.detail.response.returnval;
        var no_of_student = routereportresult.length;
        document.querySelector('routereport-card').reportarr=routereportresult;
        document.querySelector('routereport-card').no_of_student=no_of_student;
        //alert(JSON.stringify(e.detail.response.returnval));
      },
       studentdroproutereportResponse:function(e)
      {
        var routereportresult=e.detail.response.returnval;
        var no_of_student= routereportresult.length;
        document.querySelector('routereport-card').reportarr=routereportresult;
        document.querySelector('routereport-card').no_of_student=no_of_student;
        //alert(JSON.stringify(e.detail.response.returnval));
      },
     gettrip:function(routename)
      {
        routetrip=routename;
        //alert('name of route'+routetrip);
        //alert('Hi');
        this.gettripurl=sessionStorage.getItem("addrinfo")+"/gettrip";
        var obj={"triproute":"","schol":""};
        obj.schol=sessionStorage.getItem("sch");
        obj.triproute=routename;
        this.gettripparam=obj;
        //alert(JSON.stringify(obj));
        this.$.gettripajax.generateRequest();
        this.getrouteidurl=sessionStorage.getItem("addrinfo")+"/getrouteid";
        var obj1={"routename":"","schol":""}
        obj1.schol=sessionStorage.getItem("sch");
        obj1.routename=routename;
        this.getrouteidparam=obj1;
      //alert(JSON.stringify(obj1));
        this.$.getrouteidajax.generateRequest();

      },
      getrouteidResponse:function(e){
        rouid=e.detail.response.returnval[0].id;
        sessionStorage.setItem("routid",rouid);
      },
      gettripResponse:function(e1)
          {
            //alert('i m back');
          var tripdetails=e1.detail.response.returnval;
          var xx = e1.detail.response.returnval[0].id;
          //alert(JSON.stringify(tripdetails));
          //alert(JSON.stringify(routedetails));
          document.querySelector('mappointtoroute-card').triparr=tripdetails;
      },
      //cancellation
      cancellation:function(studid){
        this.cancellationurl=sessionStorage.getItem("addrinfo")+"/cancellation";
        var obj={"studid":"","schol":""}
        obj.studid=studid;
        obj.schol=sessionStorage.getItem("sch");
        this.cancellationparam=obj;
        //alert(JSON.stringify(obj));
        this.$.cancellationajax.generateRequest();
      },
      cancellationResponse:function(e){
        //alert(JSON.stringify(e.detail.response.returnval));
        var reportresult=e.detail.response.returnval;
        document.querySelector('cancellation-card').cancellationarr=reportresult;
      },
      cancel:function(school_type, fee, paid){
        this.cancelurl=sessionStorage.getItem("addrinfo")+"/cancel";
        var end_date = localStorage.getItem("localsess_curr_date",this.showdate);
        var obj={"school_type":"","end_date":"","schol":""}
        obj.schol=sessionStorage.getItem("sch");
        obj.school_type=school_type;
        cancelfee = fee;
        cancelpaid = paid;
        obj.end_date=end_date;
        this.cancelparam=obj;
        this.$.cancelajax.generateRequest();
      },
      cancelResponse:function(e){
        var school_start_date = new Date(e.detail.response.returnval[0].start_date);
        var school_end_date = new Date(e.detail.response.returnval[0].end_date);
        var end_date = new Date(localStorage.getItem("localsess_curr_date",this.showdate));
        var a = (school_end_date.getFullYear() - school_start_date.getFullYear()) * 12;
        a += school_end_date.getMonth() - school_start_date.getMonth();
        if (school_end_date.getDate() < school_start_date.getDate()){
          a--;
        }
        var b = (end_date.getFullYear() - school_start_date.getFullYear()) * 12;
        b += end_date.getMonth() - school_start_date.getMonth();
        if (end_date.getDate() < school_start_date.getDate()){
          b--;
        }
        var total_months = a + 1;
        var months_used = b + 1;
        var totalamount = cancelfee;
        var paidamount = cancelpaid;
        var remaining_months = total_months - months_used;
        var percent = (remaining_months / total_months)*100;
       // alert("percent"+' '+percent);
        var total_refund_amount = (totalamount/100)*percent;
        //alert("refund"+' '+total_refund_amount);
        var used_amount = parseInt(totalamount - total_refund_amount);
        var refund_amount = paidamount - used_amount;
        //alert("refund_amount"+' '+refund_amount);
        document.querySelector('cancellation-item-card').months_used=months_used;
        document.querySelector('cancellation-item-card').total_months=total_months;
        document.querySelector('cancellation-item-card').refund_amount=refund_amount;
      },
      proceedcancellation:function(student_id, student_name, months_used, refund_amount, reason)
      {
        this.student_id=student_id;
        this.proceedcancelurl=sessionStorage.getItem("addrinfo")+"/proceedcancel";
        var obj={"student_id":"","student_name":"","months_used":"","refund_amount":"","reason":"","schol":""}
        obj.student_id=student_id;
        obj.schol=sessionStorage.getItem("sch");
        obj.student_name=student_name;
        obj.months_used=months_used;
        obj.refund_amount=refund_amount;
        obj.reason = reason;
        this.proceedcancelparam=obj;
        this.$.proceedcancelajax.generateRequest();
      },
      proceedcancelResponse:function(e){
        var reportresult=e.detail.response.returnval;
        if(reportresult=='success'){
          alert('Cancellation Request is Sent Successfully');
              var obj={"student_id":"","schol":""}
              obj.schol=sessionStorage.getItem("sch");
        obj.student_id=this.student_id;
        this.transportrequiredstatusparam=obj;
        this.transportrequiredstatusurl=sessionStorage.getItem("addrinfo")+"/transportrequiredstatus";
        this.$.transportrequiredstatusajax.generateRequest();
        this.statuschangeurl=sessionStorage.getItem("addrinfo")+"/statuschange";
        this.statuschangeparam=obj;
        this.$.statuschangeajax.generateRequest();
        this.pointflagurl=sessionStorage.getItem("addrinfo")+"/pointflag";
        this.pointflagparam=obj;
        this.$.pointflagajax.generateRequest();
        }
        else{
          alert('Request Failed');
        }
        document.querySelector('cancellation-card').getrefreshcancel();
        document.querySelector('transport-app').setPage("cancellation","Transport Cancellation");

      },
       monthdiff:function(fromdate,todate){
        //alert('flow');
        var froms = fromdate;
        var to = todate;
        var d1 = new Date(froms);
        var d2=new Date(to);
        //alert('hi..'+d1+'   dvfa.. '+d2);
        months = (d2.getFullYear() - d1.getFullYear()) * 12;
        months -= d1.getMonth() + 1;
        months += d2.getMonth();
        var month = months+2;
        //alert(totalfee+'   '+month);
        cusfee = parseInt((totalfee/12)*month);
        //alert(cusfee);
      },
      name:function(){
        this.nameurl = sessionStorage.getItem("addrinfo")+"/name";
        var obj={"schol":""}
        obj.schol=sessionStorage.getItem("sch");
        this.nameparam=obj;
        this.$.nameajax.generateRequest();
      },
      nameResponse:function(e){
        var nameitem=e.detail.response.returnval;
        document.querySelector('cancellation-card').autocompletename(nameitem);
      },
      transportrequiredstatusResponse:function(e){

      },
      generatereportbyname:function(){
       this.generatereportbynameurl=sessionStorage.getItem("addrinfo")+"/generatereportbyname";
       var obj={"schol":""}
       obj.schol=sessionStorage.getItem("sch");
       this.generatereportbynameparam=obj;
       this.$.generatereportbynameajax.generateRequest();
      },
      generatereportbynameResponse:function(e){
        var nameitem=e.detail.response.returnval;
        document.querySelector('genestureport-card').autocompletename(nameitem);
      },
      deletemappoint:function(pointarray,routenam,tripnum)
      {
        this.deletemappointurl=sessionStorage.getItem("addrinfo")+"/deletemappoint-card";
        var obj={"pointarray":"","routenam":"","tripnum":"","schol":""}
        obj.schol=sessionStorage.getItem("sch");
        obj.pointarray=pointarray;
        obj.routenam=routenam;
        obj.tripnum=tripnum;
        this.deletemappointparam=obj;
        this.$.deletemappointajax.generateRequest();
      },
      deletemappointResponse:function(e)
      {
        alert('Data Deleted successfully');
        document.querySelector('mappointtoroute-card').refreshdeletedata();

      },
       getstudapproval:function(){

        this.getstudapprovalurl=sessionStorage.getItem("addrinfo")+"/getstudapproval";
        var obj={"schol":""}
        obj.schol=sessionStorage.getItem("sch");
        this.getstudapprovalparam=obj;
        this.$.getstudapprovalajax.generateRequest();
      },
      getstudapprovalResponse:function(e){
          var reqappro=e.detail.response.returnval;
          if(reqappro==''){
          document.querySelector('transport-app').setPage("nodata","Discount Approval");
          }
          else{
          document.querySelector('approvediscount-card').approvearr=reqappro;
        }

      },
      confirmdisc:function(stid,admrea,accdis,flag,status){
        var todat=new Date();
        var today=todat.getFullYear()+"/"+(todat.getMonth()+1)+"/"+todat.getDate();
        this.confirmdiscurl=sessionStorage.getItem("addrinfo")+"/confirmdisc";
        var obj={"stid":"","admrea":"","accdis":"","nowdate":"","flag":"","status":"","schol":""}
        obj.schol=sessionStorage.getItem("sch");
        obj.stid=stid;
        obj.admrea=admrea;
        obj.accdis=accdis;
        obj.nowdate=today;
        obj.flag=flag;
        obj.status=status;
        this.confirmdiscparam=obj;
        this.$.confirmdiscajax.generateRequest();
      },
      confirmdiscResponse:function(e){
        var resultx=e.detail.response.returnval;
        if(resultx=='success'){
          alert('Updation successfully');
        } else {
          alert('Updation Failed');
        }
        document.querySelector('approvediscount-card').freshappr();
      },
      getapprovalverify:function(){

        this.getapprovalverifyurl=sessionStorage.getItem("addrinfo")+"/getapprovalverify";
        var obj={"schol":""}
        obj.schol=sessionStorage.getItem("sch");;
        this.getapprovalverifyparam=obj;
        this.$.getapprovalverifyajax.generateRequest();
      },
      getapprovalverifyResponse:function(e){
          var verifyreq=[];
          verifyreq=e.detail.response;
          if(verifyreq=='')
          {
            document.querySelector('transport-app').setPage("nodata","Discount Verification");
          }
          else{document.querySelector('discountverify-card').theriarr=verifyreq;
        }
          //alert(JSON.stringify(verifyreq));
          //verifyreq=[{"name":"dsddsds"},{"name":"eerrere"}];

          //alert(JSON.stringify(document.querySelector('discountverify-card').theriarr));
      },
      confirmedfee:function(stid,fee,status,flag){
        var todat=new Date();
        var today=todat.getFullYear()+"/"+(todat.getMonth()+1)+"/"+todat.getDate();
        this.confirmedfeeurl=sessionStorage.getItem("addrinfo")+"/confirmedfee";
        var obj={"stid":"","fees":"","status":"","date":"","flag":"","schol":""}
        obj.schol=sessionStorage.getItem("sch");
        obj.stid=stid;
        obj.fees=fee;
        obj.status=status;
        obj.date=today;
        obj.flag=flag;
        this.confirmedfeeparam=obj;
        this.$.confirmedfeeajax.generateRequest();
        this.confirmfeeurl=sessionStorage.getItem("addrinfo")+"/confirmfee";
        var obj={"stid":"","fees":"","schol":""}
        obj.schol=sessionStorage.getItem("sch");
        obj.stid=stid;
        obj.fees=fee;
        this.confirmfeeparam=obj;
        this.$.confirmfeeajax.generateRequest();
      },

      confirmfeeResponse:function(e){
          var verifyres=e.detail.response.returnval;
          if(verifyres=='success')
          {
            alert('Fee is confirmed and updatede');
          }
          else
          {
            alert('Operation Failed');
          }
          document.querySelector('discountverify-card').freshapp();
      },
      cancelledfee:function(stid,status,flag){
        this.cancelledfeeurl=sessionStorage.getItem("addrinfo")+"/cancelledfee";
        var obj={"stid":"","status":"","flag":""}
        obj.stid=stid;
        obj.status=status;
        obj.flag=flag;
        this.cancelledfeeparam=obj;
        this.$.cancelledfeeajax.generateRequest();
      },
      cancelledfeeResponse:function(e)
      {
        var resltzx=e.detail.response.returnval;
        if(resltzx=='success')
        {
            alert('Request Cancelled');
        }
        else
        {
            alert('Operation Interupted');
        }
      },
      oneway:function(){

        this.onewayurl="../../configfile/modeofway.json";
        this.$.onewayajax.generateRequest();


      },
      onewayResponse:function(e){

          var temp=[];
          temp=e.detail.response;

          oneway=temp[0].oneway;

          val=(yearlyfee/100)*oneway;

      document.querySelector('zonetostudent-card').fee=val;
      },
      onecus:function(){
           this.onecusurl="../../configfile/modeofway.json";
        this.$.onecusajax.generateRequest();
        },
      onecusResponse:function(e){
            var temp=[];
          temp=e.detail.response;

          oneway=temp[0].oneway;

              val=(cusfee/100)*oneway;
         document.querySelector('zonetostudent-card').fee=val;

      },
      twoway:function(){
      val=yearlyfee;
      document.querySelector('zonetostudent-card').fee=val;
      },
      twocus:function(){
        val=cusfee;
        document.querySelector('zonetostudent-card').fee=val;
      },
       studzone:function(id){
              this.studzoneurl=sessionStorage.getItem("addrinfo")+"/getstudzone";
              var obj={"stid":"","schol":""}
              obj.stid=id;
              obj.schol=sessionStorage.getItem("sch");
              this.studzoneparam=obj;

              this.$.studzoneajax.generateRequest();
        },
        studzoneResponse:function(e){
          var status=e.detail.response.returnval;
              if(status=='mapped'){
                alert('The student is already mapped You Cannot Map again');
                document.querySelector('zonetostudent-card').FnClear();
              }
            document.querySelector('zonetostudent-card').status=status;
        },
        updatezone:function(studid,zone,fee,fromdatez,todatez,modez,namex,todayx,statusx)
      {
        this.updatezoneurl = sessionStorage.getItem("addrinfo")+"/updatezone";
        var obj={"studid":"","zone":"","fee":"","fromdate":"","todate":"","mode":"","name":"","today":"","status":""};
        obj.studid=studid;
        obj.zone=zone;
        obj.fee=fee;
        obj.fromdate=fromdatez;
        obj.todate=todatez;
        obj.mode=modez;
        obj.name=namex;
        obj.today=todayx;
        obj.status=statusx;
        this.updatezoneparam=obj;
       // alert(JSON.stringify(obj));
        this.$.updatezoneajax.generateRequest();
      },
      updatezoneResponse:function(e){
         var result=e.detail.response.returnval;
         //alert(result);
         if(result=="success")
         {
          alert('Updation done successfully');
         }
         else
         {
          alert('Updation interrupt');
         }
      },
      getpassdetail:function(studid){
          this.getpassnameurl=sessionStorage.getItem("addrinfo")+"/getpassname";
              var obj={"stid":"","schol":""}
              obj.stid=studid;
              obj.schol=sessionStorage.getItem("sch");
              this.getpassnameparam=obj;
              //alert(JSON.stringify(obj));
              this.$.getpassnameajax.generateRequest();
      },
       getfeedetail:function(studid){
        studentname=studid;
          this.getfeedetailurl=sessionStorage.getItem("addrinfo")+"/getfeedetail";
              var obj={"stid":"","schol":""}
              obj.stid=studid;
              obj.schol=sessionStorage.getItem("sch");
              this.getfeedetailparam=obj;
              this.$.getfeedetailajax.generateRequest();
      },

      getzonedetail:function(studid){
        this.getzonedetailurl=sessionStorage.getItem("addrinfo")+"/getzonedetail";
        var obj={"stid":"","schol":""}
        obj.stid=studid;
        obj.schol=sessionStorage.getItem("sch");
        this.getzonedetailparam=obj;
        this.$.getzonedetailajax.generateRequest();
      },
      getzonedetailResponse:function(e){
        var zonename=e.detail.response.returnval[0].zone_name;
        document.querySelector('studentpass-card').zone=zonename.toLowerCase();

      },
      getfeedetailResponse:function(e)
      {
          feedet=e.detail.response.returnval;
          //alert(feedet[0].student_id);
 this.getfeeparenturl=sessionStorage.getItem("addrinfo")+"/getfeeparent";
              var obj={"stid":""}
              obj.stid=feedet[0].student_id;
              this.getfeeparentparam=obj;
              this.$.getfeeparentajax.generateRequest();

},
getfeeparentResponse:function(e)
{

feeparent=e.detail.response.returnval;
this.getfeechequeurl=sessionStorage.getItem("addrinfo")+"/getfeecheque";
              var obj={"stid":""}
              obj.stid=feedet[0].student_id;
              this.getfeechequeparam=obj;
              this.$.getfeechequeajax.generateRequest();
            },


getfeechequeResponse:function(e)
{
  var feecheque=e.detail.response.returnval;
  var title1;

        var recarr=[];
        var recarr1=[];

        var dt=new Date();
      //var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
      var yr=dt.getFullYear()+' - '+(dt.getFullYear()+1);
//alert(JSON.stringify(e.detail.response.returnval));
var feezxc=feedet[0].installment_1;
  document.querySelector('transport-app').setPage("receipt","Receipt");
document.querySelector('receipt-card').convertrs(feezxc);
//alert(installment_1Date);
var dt1=new Date(feedet[0].installment_1Date);

 var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
      var curr_date = dt1.getDate();
      var curr_month = dt1.getMonth();
      var curr_year = dt1.getFullYear();
      var todate = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;

if(feedet[0].modeofpayment1=="Cash")
{
title="RECEIPT";
}
else
{
  title="RECEIPT";
}

var recobj={"email":"","receiptid":"","studname":"","classname":"","section":"","installtype":"","installfee":"","paytype":"","receiptno":""}
recobj.receiptno=feedet[0].receipt_no1;
recobj.studname=studentname;
recobj.classname=feeparent[0].class;
//recobj.section=feeparent[0].section;
recobj.installtype="installment1";
recobj.installfee=feedet[0].installment_1;
recobj.paytype=feedet[0].modeofpayment1;
recobj.today=todate;
recobj.stid=feedet[0].student_id;
recobj.session=yr;
recobj.parent=feeparent[0].parentname;
recobj.email=feeparent[0].parentmail;
recobj.schoolname=sessionStorage.getItem("schoolname");
recobj.schooladdr=sessionStorage.getItem("schooladdr");
recobj.title=title;
recarr.push(recobj);
document.querySelector('receipt-card').parentemail=feeparent[0].parentmail;
        document.querySelector('receipt-card').receiptarr=recarr;
        var pt=feedet[0].modeofpayment1;
       if(pt=='Cheque')
       {
         for(var j=0;j<feecheque.length;j++)
        {
          if(feecheque[j].installtype=="installment1")
          {

            var cqobj={"cheno":"","cqdate":"","bknm":""}
            cqobj.cheno=feecheque[j].cheque_no;
            var chdt=new Date(feecheque[j].cheque_date);
            var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
            var curr_date = chdt.getDate();
            var curr_month = chdt.getMonth();
            var curr_year = chdt.getFullYear();
            var todatez = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
            cqobj.cqdate=todatez;
            cqobj.bknm=feecheque[j].bank_name;
            //cheqarr.push(cqobj);
            document.querySelector('receipt-card').chequearray(cqobj);
            //document.querySelector('receipt-card').downloadpdf(recstudid);
          }
          }
       }
       if(feedet[0].installment_2>0)
       {
          var recarr1=[];
        var dt2=new Date();
      //var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
      var yr2=dt2.getFullYear()+' - '+(dt2.getFullYear()+1);
      // alert(JSON.stringify(e.detail.response.returnval));
var feezxc=feedet[0].installment_2;
  //document.querySelector('transport-app').setPage("receipt","Receipt");
document.querySelector('cqreceipt-card').convertrss(feezxc);
//alert(installment_1Date);
var dt3=new Date(feedet[0].installment_2Date);

 var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
      var curr_date = dt3.getDate();
      var curr_month = dt3.getMonth();
      var curr_year = dt3.getFullYear();
      var todate1 = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;

if(feedet[0].modeofpayment2=="Cash")
{
title1="RECEIPT";
}
else
{
  title1="ACKNOWLEDGEMENT";
}

var recobj1={"email":"","receiptid":"","studname":"","classname":"","section":"","installtype":"","installfee":"","paytype":"","receiptno":""}
recobj1.receiptno=feedet[0].receipt_no2;
recobj1.studname=studentname;
recobj1.classname=feeparent[0].class;
recobj1.section=feeparent[0].section;
recobj1.installtype="installment2";
recobj1.installfee=feedet[0].installment_2;
recobj1.paytype=feedet[0].modeofpayment2;
recobj1.today=todate1;
recobj1.stid=feedet[0].student_id;
recobj1.session=yr2;
recobj1.parent=feeparent[0].parentname;
recobj1.email=feeparent[0].parentmail;
recobj1.schoolname=sessionStorage.getItem("schoolname");
recobj1.schooladdr=sessionStorage.getItem("schooladdr");
recobj1.title=title1;
recarr1.push(recobj1);
document.querySelector('cqreceipt-card').parentemail=feeparent[0].parentmail;

document.querySelector('cqreceipt-card').receiptarr=recarr1;
 var pt1=feedet[0].modeofpayment2;
       if(pt1=='Cheque')
       {
  for(var j=0;j<feecheque.length;j++)
        {
          if(feecheque[j].installtype=="installment2")
          {

            var cqobj1={"cheno":"","cqdate":"","bknm":""}
            cqobj1.cheno=feecheque[j].cheque_no;
            var chdt1=new Date(feecheque[j].cheque_date);
            var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
            var curr_date = chdt1.getDate();
            var curr_month = chdt1.getMonth();
            var curr_year = chdt1.getFullYear();
            var todatezz = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
            cqobj1.cqdate=todatezz;
            cqobj1.bknm=feecheque[j].bank_name;
            //cheqarr.push(cqobj);
            document.querySelector('cqreceipt-card').chequearray(cqobj1);
            //document.querySelector('receipt-card').downloadpdf(recstudid);
          }
          }
       }


}
      },

      getpassnameResponse:function(e){
          var idst=e.detail.response.returnval[0].id;
          var classid=e.detail.response.returnval[0].class_id;
          var bloodgp=e.detail.response.returnval[0].blood_group;
          document.querySelector('studentpass-card').blood=bloodgp;
          document.querySelector('studentpass-card').sid=idst;
          //alert('st d '+idst);
          this.getpassdetailurl=sessionStorage.getItem("addrinfo")+"/getpassdetail";
          var obj={"stid":"","schol":""}
          obj.stid=idst;
          obj.schol=sessionStorage.getItem("sch");
          this.getpassdetailparam=obj;
          this.$.getpassdetailajax.generateRequest();


          this.getparentinfourl=sessionStorage.getItem("addrinfo")+"/getparentinfo";
          this.getparentinfoparam=obj;
          //alert(JSON.stringify(obj));
          this.$.getparentinfoajax.generateRequest();


          this.getpassclassurl=sessionStorage.getItem("addrinfo")+"/getpassclass";
          var obj3={"class":"","schol":""}
          obj3.class=classid;
          obj3.schol=sessionStorage.getItem("sch");
          this.getpassclassparam=obj3;
          this.$.getpassclassajax.generateRequest();
      },
       getpassdetailResponse:function(e){
        var pp=e.detail.response.returnval[0].pickup_point;
        var dp=e.detail.response.returnval[0].drop_point;
        var pickrou = e.detail.response.returnval[0].pickup_route_id;
        var droprou = e.detail.response.returnval[0].drop_route_id;

          this.getppnameurl=sessionStorage.getItem("addrinfo")+"/getpointname";
              var obj={"point":"","schol":""}
              obj.point=pp;
              obj.schol=sessionStorage.getItem("sch");
             this.getppnameparam=obj;
              this.$.getppnameajax.generateRequest();

          this.getdpnameurl=sessionStorage.getItem("addrinfo")+"/getpointname";
          var obj2={"point":"","schol":""}
          obj2.point=dp;
          obj2.schol=sessionStorage.getItem("sch");
          this.getdpnameparam=obj2;
          this.$.getdpnameajax.generateRequest();

          this.getpickrouurl=sessionStorage.getItem("addrinfo")+"/getroutename";
          var obj3={"route":"","schol":""}
          obj3.route=pickrou;
          obj3.schol=sessionStorage.getItem("sch");
          this.getpickrouparam=obj3;
          alert(JSON.stringify(obj3));
          this.$.getpickrouajax.generateRequest();

          this.getdroprouurl=sessionStorage.getItem("addrinfo")+"/getroutename";
          var obj4={"route":"","schol":""}
          obj4.route=droprou;
          obj4.schol=sessionStorage.getItem("sch");
          this.getdroprouparam=obj4;
          alert(JSON.stringify(obj4));
          this.$.getdroprouajax.generateRequest();
        },
        getppnameResponse:function(e){
            var pickupoint=e.detail.response.returnval[0].point_name;
            document.querySelector('studentpass-card').pickup=pickupoint;
        },
        getdpnameResponse:function(e){
            var droppoint=e.detail.response.returnval[0].point_name;
            document.querySelector('studentpass-card').drop=droppoint;
        },
        getpickrouResponse:function(e){
            var pickuproute=e.detail.response.returnval[0].route_name;
            document.querySelector('studentpass-card').pickuprout=pickuproute;
        },
        getdroprouResponse:function(e){
            var droproute=e.detail.response.returnval[0].route_name;
            document.querySelector('studentpass-card').droprout=droproute;
        },
        getpassclassResponse:function(e){
            var standard=e.detail.response.returnval[0].class;
            var section=e.detail.response.returnval[0].section;
            document.querySelector('studentpass-card').stnd=standard;
            document.querySelector('studentpass-card').sec=section;
        },
        getparentinfoResponse:function(e){

          var dad1=e.detail.response.returnval[0].parent_name;
            var add1=e.detail.response.returnval[0].address1;
            var add2=e.detail.response.returnval[0].address2;
            var add3=e.detail.response.returnval[0].address3;
            var add4=e.detail.response.returnval[0].city;
            var pin=e.detail.response.returnval[0].pincode;
            var mob=e.detail.response.returnval[0].mobile;
            alert(dad1+'    '+add1+'  '+add2+'  '+add3+'  '+add4+'   '+pin+'  '+mob);
            document.querySelector('studentpass-card').parent=dad1;
            document.querySelector('studentpass-card').address1=add1;
            document.querySelector('studentpass-card').address2=add2;
            document.querySelector('studentpass-card').address3=add3;
            document.querySelector('studentpass-card').town=add4;
            document.querySelector('studentpass-card').pin=pin;
            document.querySelector('studentpass-card').mobno=mob;

        },
        classesx:function(){
            this.classurl = sessionStorage.getItem("addrinfo")+"/selectclasses";
            this.$.classesajax.generateRequest();
        },
        classesResponse:function(e){
            var select_class=e.detail.response.returnval;
            document.querySelector('student-detail-card').select_class=select_class;
        },
        addstudent:function(student_id,first_name, last_name,stu_class, stu_schooltype,stu_transport, parent_name,parent_email, parent_mobile, address_1, address_2, address_3, city, pincode,dob){
            this.addstudenturl=sessionStorage.getItem("addrinfo")+"/addstudent";
            var obj={"student_id":"","student_name":"","stu_class":"","stu_schooltype":"","stu_transport":"","dob":"","schol":""}
            obj.student_id = student_id;
            obj.student_name=first_name+" "+last_name;
            obj.stu_class=stu_class;
            obj.stu_schooltype=stu_schooltype;
            obj.stu_transport=stu_transport;
            obj.dob=dob;
            obj.schol=sessionStorage.getItem("sch");
            this.addstudentparam=obj;
            this.$.addstudentajax.generateRequest();

            this.addparenturl=sessionStorage.getItem("addrinfo")+"/addparent";
       var obj1={"schol":"","student_id":"","parentname":"","pemail":"","pmobile":"","addr1":"","addr2":"","addr3":"","city":"","pincode":""}
            obj1.schol=sessionStorage.getItem("sch");
            obj1.student_id = student_id;
            obj1.parentname=parent_name;
            obj1.pmobile=parent_mobile;
            obj1.pemail=parent_email;
            obj1.addr1=address_1;
            obj1.addr2 = address_2;
            obj1.addr3=address_3;
            obj1.city=city;
            obj1.pincode=pincode;
            this.addparentparam=obj1;
            //alert(JSON.stringify(obj1));
            this.$.addparentajax.generateRequest();


        },
        addstudentResponse:function(e){
            var addstudent=e.detail.response.returnval;
            if(addstudent=='success')
            {
                    alert('Student added successfully');
            }
            document.querySelector('student-detail-card').FnClear();
            document.querySelector('student-detail-card').ready();
        },
        getchequedetailsbyname:function(e){
           this.getchequedetailsbynameurl=sessionStorage.getItem("addrinfo")+"/getchequedetailsbyname";
           var obj={"schol":""}
           obj.schol=sessionStorage.getItem("sch");
           this.getchequedetailsbynameparam=obj;
           this.$.getchequedetailsbynameajax.generateRequest();

        },
        getchequedetailsbynameResponse:function(e){
            var nameitem=e.detail.response.returnval;
            document.querySelector('editcheque-card').autocompletearr(nameitem);

        },
        editcheque:function(student_name){
           this.getchequedetailsurl=sessionStorage.getItem("addrinfo")+"/getchequedetails";
           var obj={"schol":"","student_name":""}
           obj.schol=sessionStorage.getItem("sch");
           obj.student_name=student_name;
           this.getchequedetailsparam=obj;
           //alert(JSON.stringify(obj));
           this.$.getchequedetailsajax.generateRequest();
        },
        editchequeResponse:function(e){
            editchequedetail=e.detail.response.returnval;
            //alert(JSON.stringify(editchequedetail));
            this.geteditchequeurl=sessionStorage.getItem("addrinfo")+"/geteditcheque";
            var obj={"schol":"","stid":""}
            obj.schol=sessionStorage.getItem("sch");
            obj.stid=editchequedetail[0].student_id;
            this.geteditchequeparam=obj;
            //alert(JSON.stringify(obj));
            this.$.geteditchequeajax.generateRequest();
            //document.querySelector('studentpass-card').chequedetailarr=chequedetail;
        },
        geteditchequeResponse:function(e){
            var chequearr1=[];
            var chequearr2=[];
            var editcq=e.detail.response.returnval;
            //alert(JSON.stringify(e.detail.response.returnval));
            var id = e.detail.response.returnval[0].student_id;
            var name = e.detail.response.returnval[0].name;
            var obj={"installtype1":"","installamt1":"","paytype1":"","chequenum1":"","bankname1":"","chequedate1":""}
            obj.installamt1=editchequedetail[0].installment_1;
            obj.paytype1=editchequedetail[0].modeofpayment1;
            obj.installtype1="installment1";
            if(editchequedetail[0].modeofpayment1=="Cheque"){
                for(var i=0;i<editcq.length;i++){
                    if(editcq[i].installtype=="installment1"){
                        obj.chequenum1=editcq[i].cheque_no;
                        obj.bankname1=editcq[i].bank_name;
                        obj.chequedate1=editcq[i].cheque_date;
                    } 
                }
            }
            var obj1={"installtype2":"","installamt2":"","paytype2":"","chequenum2":"","bankname2":"","chequedate2":""}
            obj1.installamt2=editchequedetail[0].installment_2;
            obj1.paytype2=editchequedetail[0].modeofpayment2;
            obj1.installtype2="installment2";
            if(editchequedetail[0].modeofpayment2=="Cheque"){
                for(var j=0;j<editcq.length;j++){
                    if(editcq[j].installtype=="installment2"){
                        obj1.chequenum2=editcq[j].cheque_no;
                        obj1.bankname2=editcq[j].bank_name;
                        obj1.chequedate2=editcq[j].cheque_date;
                    } 
                }
            } 
            chequearr1.push(obj);
            chequearr2.push(obj1);
            alert(JSON.stringify(chequearr1));
            alert(JSON.stringify(chequearr2));
            document.querySelector('editcheque-card').editarr1=chequearr1;
            document.querySelector('editcheque-card').editarr2=chequearr2;
            document.querySelector('editcheque-card').id=id;
            document.querySelector('editcheque-card').name=name;
        },
        verify:function(id){
            this.verifyurl=sessionStorage.getItem("addrinfo")+"/verify";
            var obj={"schol":"","stid":""}
            obj.schol=sessionStorage.getItem("sch");
            obj.stid=id;
            this.verifyparam=obj;
            //alert(JSON.stringify(obj));
            this.$.verifyajax.generateRequest();
        },
        verifyResponse:function(e){
        var res=e.detail.response.returnval;
        if(res=='success')
        {
            alert('The Id Is Already Exist Please Change it');
            var d='';
            document.querySelector('student-detail-card').student_id=d;
        }
        }
    });
 })();
</script>

</dom-module>

