<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-styles/paper-styles.html">
<script src="../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="stylesheet" type="text/css" href="../../styles/styles.css">
<link rel="import" href="../timepicker-card/timepicker-card.html">
<link rel="import" href="../fetch-card/fetch-card.html">
<link rel="import" href="../item-card/item-card.html">
<link rel="import" href="../transport-service/transport-service.html">
<dom-module id="mappointtoroute-card">
  <template>  
    <body>
      <div class="dupframe">
      <table>
        <tr>
        <td style="width: 17%;"></td>
          <td>
            <paper-item label="">Route Name<paper-item>
          </td>
          <td>
            <div class="drop-down">
            <paper-dropdown-menu label="---Select the Route---">
                <paper-menu class="dropdown-content"  on-iron-select="rootname" valueattr="value" >
                   <template  is="dom-repeat" items="{{routearr}}" as="view">
              <paper-item value="{{view.route_id}}">{{view.route_name}}</paper-item>
              </template>
                </paper-menu>
            </paper-dropdown-menu>
          </div>
          </td>
          <td>
            <paper-item label="">Trip<paper-item>
          </td>
          <td>
          <div class="drop-down">
           <paper-dropdown-menu label="---Select the Trip---">
               <paper-menu class="dropdown-content"  on-iron-select="tripnum" valueattr="value" >
                   <template  is="dom-repeat" items="{{triparr}}" as="view">
              <paper-item value="{{view.trip}}">{{view.trip}}</paper-item>
              </template>
                </paper-menu>
            </paper-dropdown-menu>
          </div>    
          </td>
          <td style="width: 70px;"></td>
          <td>
          <paper-button id="button" class="button" on-click="click">Submit</paper-button>
          
          </td>
          <td>
            <paper-button id="create" class="button" on-click="clickfn">Create New</paper-button>
          </td>
        </tr>
      </table>
        <div>
            <app-service itemarr="{{itemarr}}"></app-service>
            <template  is="dom-repeat" items="{{itemarr}}">
            <fetch-card points="{{item.point_name}}" trip="{{item.trip}}" picktime="{{item.pickup_time}}" droptime="{{item.drop_time}}">
            </template>
          </div>
          
         <div id="cardnew" hidden$="{{hide}}">
            
              <item-card></item-card>
            
          </div>
                
      </div>
        
    </body>
  <transport-service id="select"></transport-service>
  </template>
 <script>
(function() {
  var routename="";
  var itemarray=[];
  var detailarr=[];
    Polymer({
      is: "mappointtoroute-card",
      ready:function()
      { 
        this.hide=true;
        this.$.select.getroute();
       },
       rootname:function(e)
       {
        routename = (e.target.selectedItem.textContent).trim();
        //alert('selected route = '+routename);
        this.$.select.gettrip(routename);
        
        sessionStorage.setItem("route",routename);
       },
       tripnum:function(e)
       {
        var tripno = (e.target.selectedItem.textContent).trim();
        this.$.select.getroutedetail(tripno);

         sessionStorage.setItem("trip",tripno);
       },
       click:function()
       {
        this.$.select.mappoint(itemarray);
       },
       clickfn:function(){
        this.hide=false;
       },
       FnGetItems:function(route,point,pickup,drop){
        var obj={"route":"","point":"","pickuptime":"","droptime":""};
        obj.route=routename;
        obj.point=point;
        obj.pickuptime=pickup;
        obj.droptime=drop;
        itemarray.push(obj);
       }

        

});
})();
  </script>

 
</dom-module>